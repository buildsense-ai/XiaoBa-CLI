topic: "CLEC早季作物分类框架改进实验"
scope: "quick"
source_analysis_dir: "docs/analysis/remotesensing-17-01783-v2/"

experiments:
  - experiment_id: E1
    hypothesis_id: H1
    task: "预测模块替换：用PatchTST/Mamba替换AtEDLSTM，提升周期性物候模式预测精度"
    datasets:
      - name: "中国东北三省多源遥感数据集（原论文数据集）"
        split: "train/val/test = 8:1:1，共17870样本"
      - name: "德国巴伐利亚州Holfeld数据集（跨区域验证）"
        split: "原论文使用的Sentinel-2时序，7种作物"
    baselines:
      - name: "CLEC-original（AtEDLSTM + 1D-CNN + GradNorm）"
        source: "原论文复现"
      - name: "1D-CNN（无级联学习）"
        source: "原论文消融实验baseline"
      - name: "DCM（DeepCropMapping）"
        source: "原论文对比模型"
      - name: "Transformer（原论文对比模型）"
        source: "原论文对比模型"
    method_variant:
      summary: "固定1D-CNN分类模块和GradNorm不变，仅替换预测模块"
      key_changes:
        - "替换方案A：PatchTST — patch-based tokenization + channel-independent设计，擅长捕获局部周期模式"
        - "替换方案B：Mamba-based predictor — 线性复杂度的SSM，适合序列建模"
        - "替换方案C：Autoformer — 自相关机制 + 序列分解，专为周期性时序设计"
        - "保持级联学习机制不变：预测输出concat早季数据后送入1D-CNN"
        - "保持损失函数不变：MSE+SSIM（预测）+ CCE（分类）+ GradNorm"
    metrics:
      primary:
        - "分类Kappa（各作物、各DOY时间点）"
        - "分类F1-score（各作物）"
      secondary:
        - "预测MSE"
        - "预测SSIM"
        - "峰谷捕获率（自定义：预测曲线在真实峰/谷±1时间步内的命中比例）"
        - "最早可识别时间（F1>0.8的最早DOY）"
    ablations:
      - name: "仅替换预测模块（PatchTST vs. Mamba vs. Autoformer vs. AtEDLSTM）"
        purpose: "隔离预测模块架构对下游分类的影响"
      - name: "预测模块+分类模块联合替换"
        purpose: "探索预测-分类模块的最优组合"
    compute_budget:
      gpu_type: "NVIDIA RTX 3090 / A100"
      max_gpu_hours: 50
    success_criteria:
      - "至少一个替换方案在DOY 140-190阶段的平均Kappa比原始CLEC提升≥2%"
      - "预测数据在关键物候事件处的SSIM提升≥5%"
      - "最早可识别时间不晚于原始CLEC"
    failure_criteria:
      - "所有替换方案的Kappa均低于原始CLEC"
      - "预测精度提升但下游分类无改善（说明瓶颈不在预测模块）"
    risks:
      - "短序列（6-18步）上Transformer/Mamba可能无优势"
      - "新预测模块与GradNorm的梯度流可能不兼容，需调参"
    fallback_plan:
      - "若单一替换无效，尝试ensemble：AtEDLSTM + PatchTST预测取平均"
      - "若短序列是瓶颈，尝试更细粒度的时间合成（5日而非10日）"
    repro_requirements:
      seed: 42
      runs_per_setting: 3

  - experiment_id: E2
    hypothesis_id: H2
    task: "多任务平衡策略替换：用轻量级方法替代GradNorm，降低训练开销"
    datasets:
      - name: "中国东北三省多源遥感数据集（原论文数据集）"
        split: "train/val/test = 8:1:1，共17870样本"
    baselines:
      - name: "CLEC-original（GradNorm）"
        source: "原论文复现"
      - name: "CLEC_NoGrad（固定等权重）"
        source: "原论文消融实验"
    method_variant:
      summary: "固定AtEDLSTM+1D-CNN架构不变，仅替换多任务平衡策略"
      key_changes:
        - "方案A：Uncertainty Weighting — 基于同方差不确定性自动学习权重，无需额外反向传播"
        - "方案B：Analytical Uncertainty Weighting（Kirchdorfer 2024）— 解析最优权重"
        - "方案C：Improvable Gap Balancing（Dai 2023）— 基于损失的方法"
        - "方案D：固定权重网格搜索 — w_pred:w_cls = {0.3:0.7, 0.5:0.5, 0.7:0.3, 0.9:0.1}"
    metrics:
      primary:
        - "训练时间（秒/epoch）"
        - "分类Kappa（各作物、各DOY时间点）"
      secondary:
        - "GPU显存峰值占用"
        - "训练收敛所需epoch数"
        - "分类F1-score"
    ablations:
      - name: "各平衡策略在不同早季时间点的表现"
        purpose: "检验轻量策略在数据最稀缺阶段是否仍能有效平衡"
    compute_budget:
      gpu_type: "NVIDIA RTX 3090"
      max_gpu_hours: 20
    success_criteria:
      - "至少一个替代方案训练时间降低≥40%（≤12s/epoch）"
      - "分类Kappa下降不超过0.5%"
    failure_criteria:
      - "所有替代方案的Kappa下降超过1%"
      - "训练时间降低不足20%"
    risks:
      - "预测损失（MSE+SSIM）和分类损失（CCE）量纲差异大，简单方法可能不稳定"
      - "Uncertainty Weighting在级联结构中可能收敛慢"
    fallback_plan:
      - "若单一方法不稳定，尝试分阶段策略：前N个epoch用固定权重预热，后续切换为自适应"
      - "若所有轻量方法精度下降明显，尝试简化版GradNorm（降低更新频率）"
    repro_requirements:
      seed: 42
      runs_per_setting: 3

  - experiment_id: E3
    hypothesis_id: H3
    task: "物候感知数据增强：提升非标准生长条件下的分类鲁棒性"
    datasets:
      - name: "中国东北三省多源遥感数据集（原论文数据集）"
        split: "train/val/test = 8:1:1，共17870样本"
      - name: "模拟非标准条件测试集（从原始测试集构造）"
        split: "对原始测试集施加扰动生成"
    baselines:
      - name: "CLEC-original（无数据增强）"
        source: "原论文复现"
      - name: "CLEC + 随机噪声增强（非物候感知）"
        source: "自行实现"
    method_variant:
      summary: "在CLEC训练阶段引入物候感知的数据增强策略"
      key_changes:
        - "增强A：时间偏移 — 随机平移±15天（模拟晚播/早播）"
        - "增强B：NDVI缩放 — 乘以0.7-1.0的随机系数（模拟干旱）"
        - "增强C：物候阶段拉伸/压缩 — 随机拉伸或压缩生长周期±20%"
        - "增强D：组合增强 — A+B+C随机组合"
        - "模拟非标准测试集构造：对测试集施加时间偏移+15天 + NDVI×0.8"
    metrics:
      primary:
        - "标准条件测试集Kappa"
        - "模拟非标准条件测试集Kappa"
      secondary:
        - "各作物F1-score（标准 vs. 非标准）"
        - "最早可识别时间变化"
        - "大豆-玉米混淆率（非标准条件下的关键指标）"
    ablations:
      - name: "单一增强 vs. 组合增强"
        purpose: "确定哪种增强策略贡献最大"
      - name: "增强强度梯度实验"
        purpose: "确定最优增强幅度"
    compute_budget:
      gpu_type: "NVIDIA RTX 3090"
      max_gpu_hours: 30
    success_criteria:
      - "模拟非标准条件测试集Kappa提升≥3%"
      - "标准条件测试集Kappa下降不超过1%"
    failure_criteria:
      - "标准条件Kappa下降超过2%（增强引入过多噪声）"
      - "非标准条件Kappa提升不足1%"
    risks:
      - "模拟非标准条件可能与真实非标准条件差异大"
      - "过强的增强可能破坏正常样本的学习"
    fallback_plan:
      - "若模拟测试集不够真实，尝试收集真实干旱年份数据做验证"
      - "若增强过强，引入课程学习：训练初期不增强，后期逐步加大增强强度"
    repro_requirements:
      seed: 42
      runs_per_setting: 3
